preferredLabels = { ?subject <http://www.cidoc-crm.org/cidoc-crm/P1_is_identified_by> ?appellation . ?appellation a <http://www.cidoc-crm.org/cidoc-crm/E41_Appellation> . ?appellation <http://www.cidoc-crm.org/cidoc-crm/P2_has_type> <http://www.researchspace.org/resource/system/vocab/resource_type/primary_appellation> . ?appellation <http://www.cidoc-crm.org/cidoc-crm/P190_has_symbolic_content> ?value . },{?subject crm:P190_has_symbolic_content ?value .},{ ?subject crm:P48_has_preferred_identifier ?identifier . ?identifier a <http://www.cidoc-crm.org/cidoc-crm/E42_Identifier> . ?identifier <http://www.cidoc-crm.org/cidoc-crm/P190_has_symbolic_content> ?value .},{ ?subject crm:P170i_time_is_defined_by ?timePrimitive . ?timePrimitive a crm:E61_Time_Primitive . ?timePrimitive crm:P2_has_type <http://www.researchspace.org/resource/system/vocab/resource_type/primary_time_primitive> . ?timePrimitive crm:P190_has_symbolic_content ?value .},<http://www.cidoc-crm.org/cidoc-crm/P1_is_identified_by>/<http://www.w3.org/2000/01/rdf-schema#label>,<http://www.researchspace.org/ontology/displayLabel>,<http://www.w3.org/2000/01/rdf-schema#label>,<http://www.w3.org/2004/02/skos/core#prefLabel>

preferredThumbnails = {\n    ?subject rs:PX_has_main_representation ?representation_region .\n    ?representation_region a rs:EX_Digital_Image_Region .\n    ?representation_region crmdig:L49_is_primary_area_of ?representation .\n    ?representation_region rs:boundingBox ?bb .\n    OPTIONAL {\n      ?representation crmdig:L60i_is_documented_by/crmdig:L11_had_output/rs:PX_has_file_name ?fileName .\n    }\n    OPTIONAL {\n    $subject crm:P129i_is_subject_of ?externalIIIFImage .\n    ?externalIIIFImage a crmdig:D1_Digital_Object .\n    ?externalIIIFImage crm:P2_has_type <http://iiif.io/api/image> .\n    ?externalIIIFImage crm:P129i_is_subject_of ?externalIIIFService .\n    ?externalIIIFService a crmdig:D1_Digital_Object .\n    ?externalIIIFService crm:P2_has_type <http://iiif.io/api/image#ImageService> .   \n    }\n    BIND (STRAFTER(?bb\\, 'xywh=') AS ?boundingBox)\n    BIND (STRBEFORE(?boundingBox\\, "\\,") AS ?xString)\n    BIND (STRBEFORE(STRAFTER(?boundingBox\\, "\\,")\\, "\\,") AS ?yString)\n    BIND (STRBEFORE(STRAFTER(STRAFTER(?boundingBox\\, "\\,")\\, "\\,")\\, "\\,") AS ?wString)\n    BIND (STRAFTER(STRAFTER(STRAFTER(?boundingBox\\, "\\,")\\, "\\,")\\, "\\,") AS ?hString)\n    BIND (xsd:integer(?xString) AS ?x)\n    BIND (xsd:integer(?yString) AS ?y)\n    BIND (xsd:integer(?wString) AS ?w)\n    BIND (xsd:integer(?hString) AS ?h)\n    BIND (CONCAT(COALESCE(str(?externalIIIFService)\\, CONCAT('/digilib/Scaler/IIIF/'\\, ?fileName))\\, '/'\\, ?boundingBox\\, '/!'\\, str(IF(?w <= 640\\, ?w\\, 640))\\, '\\,'\\, str(IF(?h <= 480\\, ?h\\, 480))\\, '/0/default.jpg') AS ?value)\n  },{\n  ?subject rs:PX_has_main_representation ?representation .\n  ?representation a rs:EX_Digital_Image .\n  OPTIONAL {\n    ?representation crmdig:L60i_is_documented_by/crmdig:L11_had_output/rs:PX_has_file_name ?fileName .\n  }\n  OPTIONAL {\n    $subject crm:P129i_is_subject_of ?externalIIIFImage .\n    ?externalIIIFImage a crmdig:D1_Digital_Object .\n    ?externalIIIFImage crm:P2_has_type <http://iiif.io/api/image> .\n    ?externalIIIFImage crm:P129i_is_subject_of ?externalIIIFService .\n    ?externalIIIFService a crmdig:D1_Digital_Object .\n    ?externalIIIFService crm:P2_has_type <http://iiif.io/api/image#ImageService> .   \n  }\n  BIND (CONCAT(COALESCE(str(?externalIIIFService)\\, CONCAT('/digilib/Scaler/IIIF/'\\, ?fileName))\\, '/full/!640\\,480/0/default.jpg') AS ?value)\n},{ ?subject rs:PX_has_main_representation ?representation . ?representation a rs:EX_Digital_Image . BIND(REPLACE(STR(?representation)\\, "^.*/(.*)$"\\, "$1") as ?imageID) . BIND(CONCAT('/digilib/Scaler/IIIF/'\\, ?imageID\\, '/full/!640\\,480/0/default.jpg') AS ?value) },{\n  ?subject a rs:EX_Digital_Image .\n  OPTIONAL {\n    ?subject crmdig:L60i_is_documented_by/crmdig:L11_had_output/rs:PX_has_file_name ?fileName .\n  }\n  OPTIONAL {\n    $subject crm:P129i_is_subject_of ?externalIIIFImage .\n    ?externalIIIFImage a crmdig:D1_Digital_Object .\n    ?externalIIIFImage crm:P2_has_type <http://iiif.io/api/image> .\n    ?externalIIIFImage crm:P129i_is_subject_of ?externalIIIFService .\n    ?externalIIIFService a crmdig:D1_Digital_Object .\n    ?externalIIIFService crm:P2_has_type <http://iiif.io/api/image#ImageService> .   \n  }\n  BIND (CONCAT(COALESCE(str(?externalIIIFService)\\, CONCAT('/digilib/Scaler/IIIF/'\\, ?fileName))\\, '/full/!640\\,480/0/default.jpg') AS ?value)\n},{ ?subject a rs:EX_Digital_Image . BIND(REPLACE(STR(?subject)\\, "^.*/(.*)$"\\, "$1") as ?imageID) . BIND(CONCAT('/digilib/Scaler/IIIF/'\\, ?imageID\\, '/full/!640\\,480/0/default.jpg') AS ?value) },{\n  ?subject crm:P138i_has_representation ?representation .\n  ?representation a rs:EX_Digital_Image .\n  OPTIONAL {\n    ?representation crmdig:L60i_is_documented_by/crmdig:L11_had_output/rs:PX_has_file_name ?fileName .\n  }\n  OPTIONAL {\n    $subject crm:P129i_is_subject_of ?externalIIIFImage .\n    ?externalIIIFImage a crmdig:D1_Digital_Object .\n    ?externalIIIFImage crm:P2_has_type <http://iiif.io/api/image> .\n    ?externalIIIFImage crm:P129i_is_subject_of ?externalIIIFService .\n    ?externalIIIFService a crmdig:D1_Digital_Object .\n    ?externalIIIFService crm:P2_has_type <http://iiif.io/api/image#ImageService> .   \n  }\n  BIND (CONCAT(COALESCE(str(?externalIIIFService)\\, CONCAT('/digilib/Scaler/IIIF/'\\, ?fileName))\\, '/full/!640\\,480/0/default.jpg') AS ?value)\n},{ ?subject crm:P138i_has_representation ?representation . ?representation a rs:EX_Digital_Image . BIND(REPLACE(STR(?representation)\\, "^.*/(.*)$"\\, "$1") as ?imageID) . BIND(CONCAT('/digilib/Scaler/IIIF/'\\, ?imageID\\, '/full/!640\\,480/0/default.jpg') AS ?value) },{ ?subject crm:P138i_has_representation ?representation . ?representation a rs:EX_Digital_Image_Region . ?representation crmdig:L49_is_primary_area_of ?image . ?image crmdig:L60i_is_documented_by/crmdig:L11_had_output/rs:PX_has_file_name ?fileName. ?representation rs:boundingBox ?bb. BIND(STRAFTER(?bb\\, 'xywh=') AS ?boundingBox). BIND(CONCAT('/digilib/Scaler/IIIF/'\\, ?fileName\\, '/'\\, ?boundingBox\\, '/!640\\,480/0/default.jpg') AS ?value) },{ ?subject crm:P138i_has_representation ?representation . ?representation a rs:EX_Digital_Image_Region . ?representation crmdig:L49_is_primary_area_of ?image . ?representation rs:boundingBox ?bb. BIND(STRAFTER(?bb\\, 'xywh=') AS ?boundingBox). BIND(REPLACE(STR(?image)\\, "^.*/(.*)$"\\, "$1") as ?imageID) . BIND(CONCAT('/digilib/Scaler/IIIF/'\\, ?imageID\\, '/'\\, ?boundingBox\\, '/!640\\,480/0/default.jpg') AS ?value) },<http://www.researchspace.org/ontology/PX_has_main_representation>,{ ?object <http://www.researchspace.org/ontology/PX_has_main_representation> ?subject . BIND(?subject as ?value) }

templateIncludeQuery = PREFIX rs: <http://www.researchspace.org/ontology/> PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#> PREFIX crm: <http://www.cidoc-crm.org/cidoc-crm/>  select ?type where { { FILTER(STRSTARTS(STR(??)\\, "http://www.researchspace.org/resource/user/")). BIND(rs:User as ?type). BIND(-1 as ?index) } UNION {?? <http://www.researchspace.org/ontology/PX_object_type>  ?type . BIND(0 AS ?index) } UNION {?? <http://www.cidoc-crm.org/cidoc-crm/P2_has_type>  ?type . BIND(1 AS ?index) } UNION { ?? a ?type . BIND(2 AS ?index) }  UNION { ?? a ?t .  ?t rdfs:subClassOf* ?type . FILTER (?type in (crm:E28_Conceptual_Object\\, crm:E24_Physical_Human-Made_Thing\\, crm:E39_Actor\\, crm:E53_Place\\, crm:E5_Event)). BIND(3 AS ?index) }  UNION { ?? a ?t . ?t rdfs:subClassOf+ ?type . BIND(4 AS ?index) } } ORDER BY ?index
